<casaxml xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd file:///opt/casa/code/xmlcasa/xml/casa.xsd" xmlns="http://casa.nrao.edu/schema/psetTypes.html" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">










<task type="function" name="imbaseline" category="single dish">
<shortdescription>Image-based baseline subtraction for single-dish data</shortdescription>

<description>
</description>

<input>
    <param type="path" name="imagename" kind="image" mustexist="true"><shortdescription>Name of the input spectral line image</shortdescription><description></description>
        <value/>
    </param>

    <param type="path" name="linefile" kind="text" mustexist="true"><shortdescription>output continuum subtracted image file name</shortdescription><description></description>        
        <value/>
    </param>

    <param type="bool" name="output_cont"><shortdescription>output continuum image. Name will be imagename + '.cont'</shortdescription><description></description>
        <value type="bool">False</value>
    </param>

    <param type="path" name="bloutput" kind="text" mustexist="true"><shortdescription>name of file in which best-fit parameters are written. No output if '' (default).</shortdescription><description></description>        
        <value/>
    </param>

    <param name="maskmode" type="string">
        <shortdescription>mode of setting additional channel masks</shortdescription>

        <description>mode of setting additional channel masks. &quot;list&quot; and &quot;auto&quot; are available now.</description>
        <value>list</value>
        <allowed ignorecase="true" kind="enum">
            <value>auto</value>
            <value>list</value>

        </allowed>
    </param>

    <param type="string" name="chans" subparam="true"><shortdescription>Channels to be included in the fitting</shortdescription><description>Channels to be included in the fitting</description>
        
        <value/>
    </param>

    <param type="double" name="thresh" subparam="true"><shortdescription>S/N threshold for linefinder</shortdescription><description>S/N threshold for linefinder</description>
        
        <value>5.0</value>
    </param>

    <param type="int" name="avg_limit" subparam="true"><shortdescription>channel averaging for broad lines</shortdescription><description>channel averaging for broad lines</description>
        
        <value>4</value>
    </param>

    <param type="int" name="minwidth" subparam="true"><shortdescription>the minimum channel width to detect as a line</shortdescription><description>the minimum channel width to detect as a line</description>
        
        <value>4</value>
    </param>

    <param type="intVec" name="edge" subparam="true"><shortdescription>channels to drop at beginning and end of spectrum</shortdescription><description>channels to drop at beginning and end of spectrum</description>
        
        <value type="intVec"><value>0</value><value>0</value></value>
    </param>

    <param name="blfunc" type="string">
        <shortdescription>baseline model function</shortdescription>
        <description>baseline model function [&quot;poly&quot;, &quot;chebyshev&quot;, &quot;cspline&quot;, &quot;sinusoid&quot;, or &quot;variable&quot;(expert mode)]</description>
        <value>poly</value>
        <allowed ignorecase="true" kind="enum">
            <value>poly</value>
            <value>chebyshev</value>
            <value>cspline</value>
            <value>sinusoid</value>
            <value>variable</value>
        </allowed>
    </param>

    <param type="int" name="order" subparam="true"><shortdescription>order of baseline model function</shortdescription><description>order of baseline model function</description>
        
        <value>5</value>
    </param>

    <param type="int" name="npiece" subparam="true"><shortdescription>number of element polynomials for cubic spline curve</shortdescription><description>number of element polynomials for cubic spline curve</description>
        
        <value>2</value>
    </param>

    <param type="bool" name="applyfft" subparam="true"><shortdescription>automatically set wave numbers of sinusoids</shortdescription><description>automatically set wave numbers of sinusoids</description>
        
        <value>True</value>
    </param>

        <param type="any" name="fftthresh" subparam="true"><shortdescription>threshold to select wave numbers of sinusoids</shortdescription><description>threshold to select wave numbers of sinusoids</description>
        
        <value type="double">3.0</value>
    </param>

    <param type="any" name="addwn" subparam="true"><shortdescription>additional wave numbers to use</shortdescription><description>additional wave numbers to use</description>
        
        <value type="intVec"><value>0</value></value>
    </param>

    <param type="any" name="rejwn" subparam="true"><shortdescription>wave numbers NOT to use</shortdescription><description>wave numbers NOT to use</description>
        
        <value type="intVec"/>
    </param>

    <param type="string" name="blparam" subparam="true"><shortdescription>text file that stores per spectrum fit parameters</shortdescription><description>text file that stores per spectrum fit parameters</description>
        
        <value/>
    </param>

    <param type="int" name="clipniter" subparam="true"><shortdescription>maximum iteration number for iterative fitting</shortdescription><description>maximum iteration number for iterative fitting</description>
        
        <value>0</value>
    </param>

    <param type="double" name="clipthresh" subparam="true"><shortdescription>clipping threshold for iterative fitting</shortdescription><description>clipping threshold for iterative fitting</description>
        
        <value>3.0</value>
    </param>

    <param type="string" name="dirkernel"><shortdescription>Type of kernel to use to image smoothing. Acceptable values are &quot;none&quot;, &quot;boxcar&quot;, &quot;gaussian&quot; for a gaussian kernel, &quot;image&quot; to use an image as the kernel.</shortdescription><description></description>
        
        <value>gauss</value>
        <allowed kind="enum">
            <value>none</value>
            <value>gaussian</value>
            <value>boxcar</value>
            <value>image</value>
        </allowed>
    </param>

    <param type="any" name="major" subparam="true"><shortdescription>Major axis for the kernels. Standard quantity representation. Must be specified for kernel=&quot;boxcar&quot;.</shortdescription><description>Major axis for the kernels. Standard quantity representation. Must be specified for kernel=&quot;boxcar&quot;.</description>
        
        <any type="variant" limittype="string int float record"/>
        <value type="string"/>
        <example>&quot;4arcsec&quot;</example>
    </param>

    <param type="any" name="minor" subparam="true"><shortdescription>Minor axis. Standard quantity representation. Must be specified for kernel=&quot;boxcar&quot;.</shortdescription><description>Minor axis. Standard quantity representation. Must be specified for kernel=&quot;boxcar&quot;.</description>
        
        <any type="variant" limittype="string int float record"/>
        <value type="string"/>
        <example>&quot;2arcsec&quot;</example>
    </param>

    <param type="any" name="pa" subparam="true"><shortdescription>Position angle used only for gaussian kernel. Standard quantity representation.</shortdescription><description>Position angle used only for gaussian kernel. Standard quantity representation.</description>
        
        <any type="variant" limittype="string int float record"/>
        <value type="string"/>
        <example>&quot;40deg&quot;</example>
    </param>

    <param type="string" name="kimage" subparam="true"><shortdescription>Kernel image name. Only used if kernel=&quot;i&quot; or &quot;image&quot;.</shortdescription><description>Kernel image name. Only used if kernel=&quot;i&quot; or &quot;image&quot;.</description>
        
        <value/>
    </param>

    <param type="double" name="scale" subparam="true"><shortdescription>Scale factor. -1.0 means auto-scale. Only used if kernel=&quot;i&quot; or &quot;image&quot;.</shortdescription><description>Scale factor. -1.0 means auto-scale. Only used if kernel=&quot;i&quot; or &quot;image&quot;.</description>
        
        <value>-1.0</value>
    </param>

    <param type="string" name="spkernel"><shortdescription>spectral smoothing kernel type</shortdescription><description>spectral smoothing kernel type</description>
        
        <value>none</value>
        <allowed kind="enum">
            <value>none</value>
            <value>gaussian</value>
            <value>boxcar</value>
        </allowed>
    </param>

    <param type="int" name="kwidth" subparam="true"><shortdescription>smoothing kernel width in channel</shortdescription><description>smoothing kernel width in channel</description>
        
        <value>5</value>
    </param>

    <constraints>
        <when param="maskmode">
            <equals value="list"/>
            <equals value="auto">
                    <default param="thresh"><value>5.0</value></default>
                    <default param="avg_limit"><value>4</value></default>
                    <default param="minwidth"><value>4</value></default>
                    <default param="edge"><value type="vector"><value>0</value><value>0</value></value></default>
            </equals>
        </when>

        <when param="blfunc">
            <equals value="poly">
                    <default param="order"><value>5</value></default>
                    <default param="clipthresh"><value>3.0</value></default>
                    <default param="clipniter"><value>0</value></default>
            </equals>
            <equals value="chebyshev">
                    <default param="order"><value>5</value></default>
                    <default param="clipthresh"><value>3.0</value></default>
                    <default param="clipniter"><value>0</value></default>
            </equals>
            <equals value="cspline">
                    <default param="npiece"><value>2</value></default>
                    <default param="clipthresh"><value>3.0</value></default>
                    <default param="clipniter"><value>0</value></default>
            </equals>
            <equals value="sinusoid">
                    <default param="applyfft"><value>True</value></default>
                    <default param="fftmethod"><value type="string">fft</value></default>
                    <default param="fftthresh"><value type="double">3.0</value></default>
                    <default param="addwn"><value type="intVec"><value>0</value></value></default>
                    <default param="rejwn"><value type="intVec"/></default>
                    <default param="clipthresh"><value>3.0</value></default>
                    <default param="clipniter"><value>0</value></default>
            </equals> 
            <equals value="variable">
                    <default param="blparam"><value type="string"/></default>
                    <default param="verbose"><value>False</value></default>
            </equals>
        </when>

        <when param="dirkernel">
            <equals value="gaussian">
                <default param="beam"><value type="string"/></default>
                <default param="targetres"><value type="bool">False</value></default>
                <default param="major"><value type="string"/></default>
                <default param="minor"><value type="string"/></default>
                <default param="pa"><value type="string"/></default>
            </equals>
            <equals value="boxcar">
                <default param="major"><value type="string"/></default>
                <default param="minor"><value type="string"/></default>
            </equals>
            <equals value="image">
                <default param="kimage"><value type="string"/></default>
                <default param="scale"><value type="double">-1.0</value></default>
            </equals>
            <equals value="none">
            </equals>
        </when>

        <when param="spkernel">
            <equals value="gaussian">
                <default param="kwidth"><value>5</value></default>
            </equals>
            <equals value="boxcar">
                <default param="kwidth"><value>5</value></default>
            </equals>
        </when>
    </constraints>
</input>
<returns type="any"/>

<example>

</example>

</task>

</casaxml>
